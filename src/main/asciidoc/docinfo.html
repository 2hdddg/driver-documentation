<style>
    .listingblock pre, .literalblock pre, .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint {
        background: #f9f9f9;
        border: 1px solid #dddddd;;
    }
    #header, #content, #footnotes {
        max-width: 800px;
    }
    html, body {
        font-size: 16px;
    }
</style>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

<!-- Bootstrap -->
<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<!-- CodeMirror -->
<link href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css" rel="stylesheet">
<link href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/theme/neo.min.css" rel="stylesheet">
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/addon/runmode/runmode.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/addon/mode/loadmode.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/mode/meta.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/mode/cypher/cypher.js"></script>

<script>
CodeMirror.modeURL = '//cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/mode/%N/%N.js';

// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: http://codemirror.net/LICENSE
// Modified by the DocGist team.

"use strict";

CodeMirror.colorize = function (collection, defaultMode) {
    var isBlock = /^(p|li|div|h\\d|pre|blockquote|td)$/;

    function textContent(node, out) {
        if (node.nodeType == 3) return out.push(node.nodeValue);
        for (var ch = node.firstChild; ch; ch = ch.nextSibling) {
            textContent(ch, out);
            if (isBlock.test(node.nodeType)) out.push("\n");
        }
    }

    function run(node, mode) {
        if (mode === "cypher") {
            // no need to require those modes; we always load them
            applyMode(node, mode);
            return;
        }
        var found = false;
        for (var i = 0; i < CodeMirror.modeInfo.length; i++) {
            if (CodeMirror.modeInfo[i].mode === mode) {
                found = true;
                break;
            }
        }
        if (!found) {
            // avoid loading modes that don't exist
            return;
        }
        CodeMirror.requireMode(mode, function () {
            applyMode(node, mode);
        });
    }

    function applyMode(node, mode) {
        var text = [];
        textContent(node, text);
        node.innerHTML = "";
        CodeMirror.runMode(text.join(""), mode, node);

        node.className += mode == "cypher" ? " cm-s-neo" : " cm-s-default";
    }

    if (!collection) collection = document.body.getElementsByTagName("code");

    for (var i = 0; i < collection.length; ++i) {
        var node = collection[i];
        var mode = node.getAttribute("data-lang");
        if (!mode) {
            var cls = node.className;
            if (cls && cls.indexOf("language-") === 0) {
                mode = cls.substr(9);
            } else if (cls && cls.indexOf("src-") === 0) {
                mode = cls.substr(4);
            } else {
                mode = defaultMode;
            }
        }
        if (!mode) continue;

        var info = CodeMirror.findModeByName(mode);
        if (info) {
            mode = info.mode;
        } else {
            info = CodeMirror.findModeByMIME(mode);
            if (info) {
                mode = info.mode;
            }
        }

        run(node, mode);
    }
};

function tabTheSource($content) {
    var $UL = $('<ul class="nav nav-tabs" role="tablist"/>');
    var $LI = $('<li role="presentation"/>');
    var $A = $('<a role="tab" data-toggle="tab" style="text-decoration:none;"/>');
    var $WRAPPER = $('<div class="tab-content content"/>');
    var snippets = [];
    var languageEventElements = {};
    $('div.tabbed-example', $content).each(function () {
        var $exampleBlock = $(this);
        var title = $exampleBlock.children('div.title', this).first().text();
        var languages = [];
        var $languageBlocks = {};
        $('div.listingblock', this).each(function () {
            var language = $('code', this).data('lang');
            languages.push(language);
            $languageBlocks[language] = $(this);
        });
        if (languages.length > 1) {
            snippets.push({
                '$exampleBlock': $exampleBlock,
                'languages': languages,
                '$languageBlocks': $languageBlocks
            });
        }
    });
    var idNum = 0;
    for (var ix = 0; ix < snippets.length; ix++) {
        var snippet = snippets[ix];
        var languages = snippet.languages;
        var $languageBlocks = snippet.$languageBlocks;
        var $exampleBlock = snippet.$exampleBlock;
        var idBase = 'tabbed-example-' + idNum++;
        var $wrapper = $WRAPPER.clone();
        var $ul = $UL.clone();
        for (var i = 0; i < languages.length; i++) {
            var language = languages[i];
            var $content = $($languageBlocks[language]);
            var id;
            if ($content.attr('id')) {
                id = $content.attr('id');
            } else {
                id = idBase + '-' + language;
                $content.attr('id', id);
            }
            $content.addClass('tab-pane').css('position', 'relative');
            var $li = $LI.clone();
            var $a = $A.clone();
            $a.attr('href', '#' + id).text(language).data('lang', language).on('shown.bs.tab', function (e) {
                var language = $(e.target).data('lang');
                var $elements = languageEventElements[language];
                for (var j = 0; j < $elements.length; j++) {
                    $elements[j].tab('show');
                }
            });
            if (language in languageEventElements) {
                languageEventElements[language].push($a);
            } else {
                languageEventElements[language] = [$a];
            }
            $wrapper.append($content);
            if (i === 0) {
                $li.addClass('active');
                $content.addClass('active');
            }
            $li.append($a);
            $ul.append($li);
        }
        $exampleBlock.children('div.content').first().replaceWith($ul);
        $exampleBlock.append($wrapper);
    }
}

$(document).ready(function() {
  CodeMirror.colorize();
  tabTheSource($('#content'));
});
</script>

